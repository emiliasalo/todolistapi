<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Votes databank</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/1000hz-bootstrap-validator/0.11.5/validator.js"></script>
	
	
	
	<!-- own scripts 
	<script src="api/resources/js/main.js"></script>
	<script src="api/resources/js/jquery-1.12.0.min.js"></script>
	pathing dont work -->	
<style>

.btn {
	height: 200px;
	width: 200px;

}

.resultbutton {
	padding-left: ;
	margin-left: ;
}



</style>
</head>
<body>


<div class="container-full">



		<!-- Main component for a primary marketing message or call to action -->
	<div id="emptyspace">
		</div>
		
		<div id="emptyspace">
			<h1 id="thanks" class="text-center"></h1>
		</div>
		<br>



		<div class="row">
			<div class="col-md-2 col-xs-2 col-md-offset-1 col-xs-offset-1">
				<button class="btn-link feeling" value="1">
					<img src="images1" class="img-responsive"
						alt="Smiley face">
				</button>
			</div>
			<div class="col-md-2 col-xs-2">
				<button class="btn-link feeling" value="2">
					<img src="images2" class="img-responsive"
						alt="Smiley face">
				</button>
			</div>
			<div class="col-md-2 col-xs-2">
				<button class="btn-link feeling" value="3">
					<img src="images3" class="img-responsive"
						alt="Smiley face">
				</button>
			</div>
			<div class="col-md-2 col-xs-2">
				<button class="btn-link feeling" value="4">
					<img src="images4" class="img-responsive"
						alt="Smiley face">
				</button>
			</div>
			<div class="col-md-2 col-xs-2">
				<button class="btn-link feeling" value="5">
					<img src="images5" class="img-responsive"
						alt="Smiley face">
				</button>
			</div>
		</div>
		<div id="emptyspace">
			<div class="row" id="numberrow">
				<div class="col-md-2 col-xs-2 col-md-offset-1 col-xs-offset-1">
					<h3 class="text-center">1</h3>
				</div>
				<div class="col-md-2 col-xs-2">
					<h3 class="text-center">2</h3>
				</div>
				<div class="col-md-2 col-xs-2">
					<h3 class="text-center">3</h3>
				</div>
				<div class="col-md-2 col-xs-2">
					<h3 class="text-center">4</h3>
				</div>
				<div class="col-md-2 col-xs-2">
					<h3 class="text-center">5</h3>
				</div>
			</div>
		</div>




		<div class="row" text-align="left">
			<div class="col-md-4 col-xs-10 col-md-offset-4 col-xs-offset-1">
				

				<h2 id="result" class="text-center"></h2>

				
				</div>
				<!-- BUTTONS -->
				<br><br><br><br><br><br><br><br><br><br><br>
				<br><br><br><br><br><br>
		
		<div style="padding-left: 5%" class="container">		
<div class="row">
  <div class="col-md-3 resultbutton"><button id="results" class="btn btn-primary btn-block">Show results</button>
</div>
  <div class="col-md-3 resultbutton"><button class="btn btn-success btn-block" id="add">Add results to database</button>
</div>
 <div class="col-md-3 resultbutton"><button id="reset" class="btn btn-primary btn-block">Reset</button>
</div>
<div class="col-md-3 resultbutton"><button id="reset" class="btn btn-primary btn-block" onclick="location.href='/results';">Results</button>
</div>
</div>
		</div>		
		
			</div>
			<!-- row ends -->




		</div>
		
		<!-- container ends -->




<!-- original code below -->

</body>
<script>




//SMILEAPPLICATION CODE BELOW

$(document).ready(function() {
	
					var name = "";
					var ask = 0;
					ask = getCookie("askcookie");

					if (ask != 1) {
						var name = prompt("Name of the class:", "");
						setCookie("askcookie", 1, 365);
						setCookie("namecookie", name, 365);
						
						//sets the lecture name as a heading
						$("#thanks").html(name);
					}
					
					

					// initial values
					var allpoints = 0;
					var votes = 0;
					var average = 0;
					var shown = 0;
					var points1 = 0;
					var points2 = 0;
					var points3 = 0;
					var points4 = 0;
					var points5 = 0;
					// if cookies got values, set them to variables
					average = getCookie("averagecookie");
					points1 = getCookie("points1cookie");
					points2 = getCookie("points2cookie");
					points3 = getCookie("points3cookie");
					points4 = getCookie("points4cookie");
					points5 = getCookie("points5cookie");
					allpoints = getCookie("allpointscookie");
					votes = getCookie("votescookie");
					name = getCookie("namecookie");

					$("#result").html(
							"Grades given: " + votes
									+ "<br><br> Average of the grades: "
									+ average + "<br> <br> Grade 1 votes: " + points1
									+ "<br> Grade 2 votes: " + points2 + "<br> Grade 3 votes: " + points3
									+ "<br> Grade 4 votes: " + points4 + "<br> Grade 5 votes: " + points5);

					$("#result").hide();

					// adds feeling, depending on the value of the button
					$('.feeling')
							.click(
									function() {

										$('.feeling').prop("disabled", true);

										allpoints = Number(allpoints)
												+ Number($(this).val());

										if (Number($(this).val()) === 1) {
											points1 = Number(points1) + 1;

										} else if (Number($(this).val()) === 2) {
											points2 = Number(points2) + 1;
										} else if (Number($(this).val()) === 3) {
											points3 = Number(points3) + 1;
										} else if (Number($(this).val()) === 4) {
											points4 = Number(points4) + 1;
										} else if (Number($(this).val()) === 5) {
											points5 = Number(points5) + 1;
										}
										$(".feeling").hide();
										$("#numberrow").hide();
										$(this).show();

										votes = Number(votes) + 1

										$("#thanks").html("Thank you!").fadeIn(
												"fast");
										$("#thanks").css({
											"font-weight" : "bold",
											"font-size" : "80px",
											"color" : "green"
										});

										average = allpoints / votes;
										average = average.toFixed(2);

										setCookie("averagecookie", average,
												365);
										setCookie("votescookie", votes, 365);
										setCookie("points1cookie", points1,
												365);
										setCookie("points2cookie", points2,
												365);
										setCookie("points3cookie", points3,
												365);
										setCookie("points4cookie", points4,
												365);
										setCookie("points5cookie", points5,
												365);
										setCookie("allpointscookie",
												allpoints, 365);

										$("#result")
												.html(
														"Grades given: "
																+ votes
																+ "<br><br> Average of the grades: "
																+ average
																+ "<br> <br> Grade 1 votes: "
																+ points1
																+ "<br> Grade 2 votes: "
																+ points2
																+ "<br> Grade 3 votes: "
																+ points3
																+ "<br> Grade 4 votes: "
																+ points4
																+ "<br> Grade 5 votes: "
																+ points5);
										setTimeout(changeText, 1000);

									});

					// shows "thank you"-text and returns the original text
					// back
					function changeText() {

						$("#thanks").fadeOut(function() {
							$(this).text(name).fadeIn("fast");
							$("#thanks").css({
								"font-weight" : "normal",
								"font-size" : "40px",
								"color" : "black"
							});
							$('.feeling').prop("disabled", false);
						});
						$(".feeling").fadeIn("slow");
						$("#numberrow").fadeIn("slow");

					}

					// shows results on page
					$('#results').click(function() {

						if (shown == 1) {
							$("#result").hide();
							shown = 0;
							$("#results").text("Show results");
						} else {
							$("#result").show();
							shown = 1;
							$("#results").text("Hide results");
						}

					});

					//nollaa javascript muuttujien arvot ja keksit
					$('#reset')
							.click(
									function() {

										
										setCookie("averagecookie", "", 365);
										setCookie("votescookie", "", 365);
										setCookie("points1cookie", "", 365);
										setCookie("points2cookie", "", 365);
										setCookie("points3cookie", "", 365);
										setCookie("points4cookie", "", 365);
										setCookie("points5cookie", "", 365);
										setCookie("allpointscookie", "",
												365);

										average = getCookie("averagecookie");
										votes = getCookie("votescookie");
										points1 = getCookie("points1cookie");
										points2 = getCookie("points2cookie");
										points3 = getCookie("points3cookie");
										points4 = getCookie("points4cookie");
										points5 = getCookie("points5cookie");
										allpoints = getCookie("allpointscookie");
										

										$("#result")
												.html(
														"Grades given: "
														+ votes
														+ "<br><br> Average of the grades: "
														+ average
														+ "<br> <br> Grade 1 votes: "
														+ points1
														+ "<br> Grade 2 votes: "
														+ points2
														+ "<br> Grade 3 votes: "
														+ points3
														+ "<br> Grade 4 votes: "
														+ points4
														+ "<br> Grade 5 votes: "
														+ points5);
									});
					

					// sets cookie
					function setCookie(cname, cvalue, exdays) {
						var d = new Date();
						d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
						var expires = "expires=" + d.toUTCString();
						document.cookie = cname + "=" + cvalue + "; " + expires;
					}
					// gets cookie
					function getCookie(cname) {
						var name = cname + "=";
						var ca = document.cookie.split(';');
						for (var i = 0; i < ca.length; i++) {
							var c = ca[i];
							while (c.charAt(0) == ' ')
								c = c.substring(1);
							if (c.indexOf(name) == 0)
								return c.substring(name.length, c.length);
						}
						return "";
					}
					// add grade to database
					$('#add').click(
							function() {
								var date = new Date();
								var date = date.getFullYear() + "-"
										+ (date.getMonth() + 1) + "-"
										+ date.getDate();

								var json = {
									"feeling1" : points1,
									"feeling2" : points2,
									"feeling3" : points3,
									"feeling4" : points4,
									"feeling5" : points5,
									"average" : average,
									"votes" : votes,
									"name" : name,
									"date" : date
								};

								$.ajax({
									url : "/votes",
									data : JSON.stringify(json),
									type : "POST",

									beforeSend : function(xhr) {
										xhr.setRequestHeader("Accept",
												"application/json");
										xhr.setRequestHeader("Content-Type",
												"application/json");
									}
								});
								console.log('Success: ' + "data added");
//								console.log(JSON.stringify(data));
								alert("results added to database");
							});

				}); // document.ready ends




	
</script>
</html>